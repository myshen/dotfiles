# loaded for interactive shells

# non-interactive base config
. ~/.dotfiles/bash-like-common/env

# Interactive stuff follows
source_file_if_exists /etc/bashrc;
source_file_if_exists ${DOTFILES}/bash-like-common/aliases;
source_file_if_exists ${DOTFILES}/bash/aliases;
source_file_if_exists ${DOTFILES}/bash/prompt;
source_file_if_exists /usr/share/autojump/autojump.sh

source_file_if_exists "${DOTFILES}/bash/completion"

# ENV #########################################################################
export HISTCONTROL=ignoreboth

# Update window size after every command
shopt -s checkwinsize

shopt -s histappend
# Save multi-line commands as one command
shopt -s cmdhist
unset HISTFILESIZE
export HISTSIZE=1000000
export HISTIGNORE='&:[  ]*:ls:bg:fg:history:exit:clear:reset:git st:git co:git lg:gst:cd ..:jobs'
export HISTCONTROL="ignoreboth:erasedups"
export HISTTIMEFORMAT='%F %T '

export TERM="screen-256color"

# Color for Man pages in less (doesn't work in zsh; untested otherwise)
# https://linuxtidbits.wordpress.com/2009/03/23/less-colors-for-man-pages/
export LESS_TERMCAP_mb="$(printf '\e[01;31m')"       # begin blinking
export LESS_TERMCAP_md="$(printf '\e[01;38;5;74m')"  # begin bold
export LESS_TERMCAP_me="$(printf '\e[0m')"           # end mode
export LESS_TERMCAP_se="$(printf '\e[0m')"           # end standout-mode
export LESS_TERMCAP_so="$(printf '\e[38;5;246m')"    # begin standout-mode - info box
export LESS_TERMCAP_ue="$(printf '\e[0m')"           # end underline
export LESS_TERMCAP_us="$(printf '\e[04;38;5;146m')" # begin underline

## BETTER DIRECTORY NAVIGATION ##

# Prepend cd to directory names automatically
shopt -s autocd 2> /dev/null
# Correct spelling errors during tab-completion
shopt -s dirspell 
# Correct spelling errors in arguments supplied to cd
shopt -s cdspell 2> /dev/null

# This defines where cd looks for targets
# Add the directories you want to have fast access to, separated by colon
# Ex: CDPATH=".:~:~/projects" will look for targets in the current working directory, in home and in the ~/projects folder
CDPATH="."


# Prevent file overwrite on stdout redirection
# Use `>|` to force redirection to an existing file
set -o noclobber

# Enable incremental history search with up/down arrows (also Readline goodness)
# Learn more about this here: http://codeinthehole.com/writing/the-most-important-command-line-tip-incremental-history-searching-with-inputrc/
bind '"\e[A": history-search-backward'
bind '"\e[B": history-search-forward'
bind '"\e[C": forward-char'
bind '"\e[D": backward-char'

## SMARTER TAB-COMPLETION (Readline bindings) ##

# Perform file completion in a case insensitive fashion
bind "set completion-ignore-case on"

# Treat hyphens and underscores as equivalent
bind "set completion-map-case on"

# Display matches for ambiguous patterns at first tab press
bind "set show-all-if-ambiguous on"

# Can't set this on cygwin, it's managed by windows
if [[ "$(uname -o)" != "Cygwin" ]]; then
	ulimit -S -u 256
fi
